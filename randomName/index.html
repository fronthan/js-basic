<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8"/>
    <title>Functions: Task 1</title>
    <style>
     .main_container {max-width:1250px; margin: 0 auto;}
        h1 {color:#4d4d4d}
        p {color:#ccc}
        .result {display: flex; flex-wrap:wrap; list-style:none;}
        .result li {padding: 15px 0; width:50px; text-align: center;}
    </style>
  </head>

  <body>
    <div class="main_container">
        <h1>무작위 이름 출력 : 선언된 배열의 이름 중 무작위</h1>
        <p>21.01.</p>

        <section class="result">
    
        </section>
    </div>

    <script>
        let names = ['Chris', 'Li Kang', 'Anne', 'Francesca', 'Mustafa', 'Tina', 'Bert', 'Jada', '한','민','정'];
        let para = document.createElement('div');
        
        // Add your code here
        let set_nbr = 0;
        init();      
    
        function init() {
            let random_number = chooseName();
            
            const cookieCheck = getCookie("todayCookie");
            
            if (cookieCheck == null) {//당일 처음 들어오면
                setCookie("todayCookie", "justtodaycookie", 1);
                setStorage(random_number);                
            } else {
                set_nbr = localStorage.getItem("lastNumber");
                console.log(set_nbr);
                compareNbr(set_nbr, random_number);
            }
        }

        function chooseName() {// 랜덤 숫자 추출 
            return Math.floor(Math.random()*names.length);
        }

        function compareNbr(pre, now) {//로컬 스토리지와 값 비교
            let i, compare_again;

            if (pre == now) {
                compare_again = chooseName();
                i = pre;

                while ( i == compare_again ) {
                   compare_again = chooseName();
                }
            }

            setStorage(compare_again);
        }
        
        function setStorage(n) {
            para.textContent = names[n];
            localStorage["lastNumber"] = n;
        }

        //쿠키 셋팅 (당일 한정)
        function setCookie(name, value, exp) {
            let date = new Date();
            date.setTime(date.getTime() + exp*24*60*60*1000);
            document.cookie = name + '=' + value + ';expires=' + date.toUTCString() + ';path=/';
        }

        //쿠키확인
        function getCookie(today_yn) {            
            var value = document.cookie.match('(^|;) ?' + today_yn + '=([^;]*)(;|$)');
            
            return value ? value[2] : null;
        }

        const section = document.querySelector('.result');
        section.appendChild(para);
    </script>
 </body>
</html>